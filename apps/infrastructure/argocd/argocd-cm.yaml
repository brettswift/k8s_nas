# ArgoCD main configuration
apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
  namespace: argocd
  labels:
    app.kubernetes.io/part-of: argocd
    app.kubernetes.io/name: argocd-cm
data:
  # Enable admin account
  admin.enabled: "true"
  # Admin account capabilities
  accounts.admin: login, apiKey
  # Homepage monitoring user - apiKey only (no login)
  accounts.homepage: apiKey
  # Base href for UI (must match ingress path)
  server.basehref: "/argocd/"
  # Enable exec (terminal access)
  exec.enabled: "true"
  # Resource customizations for better UI support
  resource.customizations: |
    batch/Job:
      health.lua: |
        hs = {}
        hs.status = "Healthy"
        hs.message = "Job completed successfully"
        return hs
    batch/CronJob:
      health.lua: |
        hs = {}
        hs.status = "Healthy"
        return hs
    apps/Deployment:
      actions: |
        - action: logs
          displayName: View Logs
          iconClass: fa fa-file-text-o
    apps/ReplicaSet:
      actions: |
        - action: logs
          displayName: View Logs
          iconClass: fa fa-file-text-o
    v1/Pod:
      actions: |
        - action: logs
          displayName: View Logs
          iconClass: fa fa-file-text-o
